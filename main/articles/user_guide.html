<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="psborrow">
<title>User Guide: Dynamic Borrowing with psborrow â€¢ psborrow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="User Guide: Dynamic Borrowing with psborrow">
<meta property="og:description" content="psborrow">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">psborrow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Analysis.html">Analysing data with psborrow</a>
    <a class="dropdown-item" href="../articles/user_guide.html">User Guide: Dynamic Borrowing with psborrow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>User Guide: Dynamic Borrowing with psborrow</h1>
                        <h4 data-toc-skip class="author">Yichen Lu</h4>
            
            <h4 data-toc-skip class="date">2023-03-01</h4>
      
      
      <div class="d-none name"><code>user_guide.Rmd</code></div>
    </div>

    
    
<p>This <code>psborrow</code> package aims to evaluate the effect of
external borrowing using an integrated approach that combines propensity
score and Bayesian dynamic borrowing methods. Users are encouraged to
check the helper page for each function to understand the requirements
for parameter inputs and the format of the outputs.</p>
<p>Here we demonstrate the usage of the package with an example. The
goal is to:</p>
<ul>
<li>Simulate covariates for external control, internal control, and
internal treatment arms</li>
<li>Generate censored survival times</li>
<li>Run Markov chain Monte Carlo (MCMC) to generate the posterior
distribution for Bayesian hierarchical model</li>
<li>Summarize posterior distributions for treatment effect estimate</li>
</ul>
<div class="section level2">
<h2 id="install-the-package">Install the package<a class="anchor" aria-label="anchor" href="#install-the-package"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">psborrow</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-covariates">Simulate covariates<a class="anchor" aria-label="anchor" href="#simulate-covariates"></a>
</h2>
<p>We start with making the sample size for internal control, internal
treatment, and external control arms to be 200, 180 and 400
respectively.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss</span> <span class="op">=</span> <span class="fu"><a href="../reference/set_n.html">set_n</a></span><span class="op">(</span>ssC <span class="op">=</span> <span class="fl">200</span>, ssE <span class="op">=</span> <span class="fl">180</span>, ssExt <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
<p>We call function <code><a href="../reference/set_cov.html">set_cov()</a></code> to create two binary
covariates <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and one continuous covariate <span class="math inline">\(x_3\)</span> from the following multivariate
normal distribution with covariance between each pair of the variables
specified by <code>cov</code> in the order of <span class="math inline">\(Cov(x_1, x_2)\)</span>, <span class="math inline">\(Cov(x_1, x_3)\)</span>, and <span class="math inline">\(Cov(x_2, x_3)\)</span>.</p>
<p><span class="math display">\[\begin{aligned}
\begin{bmatrix}
x_1\\x_2\\x_3\\
\end{bmatrix}
&amp;\sim N \left( \begin{bmatrix} 0\\ 0.5\\0.5 \end{bmatrix},
\begin{bmatrix}
1 &amp; 0.5 &amp; 0.7\\
0.5 &amp; 1.2 &amp; 0.9\\
0.7 &amp; 0.9 &amp; 1\\
\end{bmatrix} \right)
\end{aligned}\]</span></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_cov.html">set_cov</a></span><span class="op">(</span></span>
<span>  n_cat <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_cont <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu_int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  mu_ext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  prob_int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.55</span><span class="op">)</span>,</span>
<span>  prob_ext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.55</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are further converted to binary
variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> using quantiles of the normal
distribution calculated from the probability specified by
<code>prob_int</code> for internal trial and by <code>prob_ext</code>
for external trial:</p>
<p><span class="math display">\[
\begin{aligned}
  \text{internal: Pr} (X_1 = 1) &amp;= 0.45 \\
  \text{Pr}(X_2 = 1) &amp;= 0.55\\
  \text{external: Pr} (X_1 = 1) &amp;= 0.65\\
  P(X_2 = 1) &amp;= 0.55\\
\end{aligned}
\]</span></p>
<p>The package enables the user to add covariates in batch.
<code>covset2</code> includes information for two continuous covariates
and three binary covariates. We set <code>mu_int = 0</code> to have the
mean for all five variables in this cluster to be 0 in the internal
trial. The same rule applies to parameter <code>mu_ext</code>,
<code>var</code>, <code>cov</code>, <code>prob_int</code> and
<code>prob_ext</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_cov.html">set_cov</a></span><span class="op">(</span></span>
<span>  n_cat <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_cont <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  mu_int <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  mu_ext <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  var <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  cov <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  prob_int <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We then combine <code>covset1</code> and <code>covset2</code>, and
call function <code><a href="../reference/simu_cov.html">simu_cov()</a></code> to simulate the covariates and add
them to the treatment variables saved in <code>ss</code>.</p>
<p>In this step, we also set the <strong>true</strong> hazard ratio
<code>HR</code> between the internal treatment and control arm, and the
hazard ratio <code>driftHR</code> between the external control and
internal control arms. User can provide a list of different
<code>HR</code> and <code>driftHR</code> values to test a range of
different hazard ratios between the three arms.</p>
<p>The number of simulations <code>nsim</code> and seed parameters
<code>seed</code> are included in the same statement to produce
reproducible results. <code>sample_cov</code> is a list of 8
matrices.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">covset1</span>, <span class="va">covset2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simu_cov.html">simu_cov</a></span><span class="op">(</span></span>
<span>  ssObj <span class="op">=</span> <span class="va">ss</span>, </span>
<span>  covObj <span class="op">=</span> <span class="va">cov_list</span>,</span>
<span>  HR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.67</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  driftHR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">47</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><em>Example of one simulated dataset (matrix) with covariates and
treatment arm information from output <code>sample_cov</code>:</em></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample_cov</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      driftHR   HR ext trt cov1 cov2         cov3 cov4 cov5        cov6</span></span>
<span><span class="co">#&gt; [1,]       1 0.67   1   0    0    0  1.426442353    1    1  0.06551554</span></span>
<span><span class="co">#&gt; [2,]       1 0.67   1   0    1    1  0.413408109    1    1 -0.86978705</span></span>
<span><span class="co">#&gt; [3,]       1 0.67   1   0    1    1 -0.667792987    1    1 -0.52705950</span></span>
<span><span class="co">#&gt; [4,]       1 0.67   1   0    0    1 -0.008703362    1    1 -0.66796308</span></span>
<span><span class="co">#&gt; [5,]       1 0.67   1   0    1    1 -0.941826735    0    0  0.90304807</span></span>
<span><span class="co">#&gt;             cov7        cov8</span></span>
<span><span class="co">#&gt; [1,]  0.06551554  0.06551554</span></span>
<span><span class="co">#&gt; [2,] -0.86978706 -0.86978706</span></span>
<span><span class="co">#&gt; [3,] -0.52705948 -0.52705948</span></span>
<span><span class="co">#&gt; [4,] -0.66796308 -0.66796308</span></span>
<span><span class="co">#&gt; [5,]  0.90304809  0.90304809</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a>
</h2>
<div class="section level3">
<h3 id="time-to-event">Time-to-event<a class="anchor" aria-label="anchor" href="#time-to-event"></a>
</h3>
<p>The second part involves generating time-to-events from either a
piece-wise exponential distribution or weibull distribution. In the
example below, we assume the survival time follows the piece-wise
exponential distirbution such that baseline hazard rate is constant in
months 1-2, and from month 3 onward. The baseline hazard rate
(<code>lambdaC</code>) for patients with all covariate equaling 0 in the
internal control arm in these time periods are 0.0135 and 0.2,
respectively. The baseline hazard rate for the internal treatment and
external control arm are the product of <code>lambdaC</code> and
<code>HR</code>, <code>driftHR</code>, respectively.</p>
<p>The calculation below details how we draw event time for each patient
following an exponential distribution. For each patient, we calculate a
specific <span class="math inline">\(\lambda\)</span> value based on the
trial and treatment indicator, along with the covariate values for this
patient.</p>
<p><span class="math display">\[
\begin{aligned}
f(t) &amp;= v\lambda t^{v-1} e^{-\lambda t^v} \\
F(t) &amp;= 1 - e^{-\lambda t^v} \\
\lambda(t) &amp;= \lambda v t ^{v-1} \\
\\
v &amp;\text{: shape parameter (user-specified)}\\
\lambda &amp;\text{: rate parameter}\\
\lambda_c &amp;\text{: baseline hazard rate at time 0 for internal
control patient with covariates }
X = 0 \\
\\
\text{Alternative parameterizations}\\
f(t) &amp;= \frac{v}{k} \left( \frac{t}{k} \right) ^{v-1}
e^{-\frac{t}{k}^v} \\
&amp;= v \left( \frac{1}{k} \right) ^{v} t^{v-1} e^{- \left(\frac{t}{k}
\right) ^v} \\
\lambda &amp;= \left( \frac{1}{k} \right) ^ v\\
\lambda(t) &amp;= \lambda v t ^{v-1} \\
log(k) &amp;= - \frac{1}{v} log(\lambda) \\
k &amp;\text{: scale parameter (input for rweibull in R, one k for each
patient)}\\
\\
\text{Internal control}\\
\lambda &amp;= \lambda_c \times e^{X \beta}\\
\lambda(t) &amp;= \lambda_c \times e^{X \beta} \times v t ^{v-1} \\
log(k) &amp;= - \frac{1}{v} \Bigl[ log (\lambda_c) + X \beta \Bigr] \\
\\
\text{Internal treatment}\\
\lambda &amp;= \lambda_c \times \text{HR} \times e^{X \beta} \\
\lambda(t) &amp; = \lambda_c \times \text{HR} \times e^{X \beta} \times
v t ^{v-1}\\
log(k) &amp;= - \frac{1}{v} \Bigl[ log(\lambda_c) + log(\text{HR}) +
e^{X \beta} \Bigr] \\
\\
\text{External control} \\
\lambda &amp;= \lambda_c \times \text{driftHR} \times e^{X \beta} \\
\lambda(t) &amp;= \lambda_c \times \text{driftHR} \times e^{X \beta}
\times v t ^{v-1} \\
log(k) &amp;= - \frac{1}{v} \Bigl[ log(\lambda_c) + log(\text{driftHR})
+ e^{X \beta} \Bigr] \\
\end{aligned}
\]</span></p>
<p>Since the covariate data we generated above in
<code>sample_cov</code> contains 8 covariates, we also want to make sure
the length of <code>beta</code> is 8.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">evt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_event.html">set_event</a></span><span class="op">(</span></span>
<span>  event <span class="op">=</span> <span class="st">"pwexp"</span>,</span>
<span>  lambdaC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0135</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>  t_itv <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fl">0.3</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Additionally, users can choose to expand the covariates when
calculating the hazard rate. In the example below, the hazard rate for
patient i from the internal control will be calculated as below. Same as
internal treatment and external control arms.</p>
<p><span class="math display">\[
\begin{aligned}
\lambda_i = \lambda_C \times e^{0.2 \times x_3 + 0.3 \times (x_1 \times
x_3) + 0.5
\times (x_2 + x_3) + 2 \times x_1^3}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_event.html">set_event</a></span><span class="op">(</span></span>
<span>  event <span class="op">=</span> <span class="st">"pwexp"</span>,</span>
<span>  lambdaC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0135</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>  t_itv <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cov1"</span>, <span class="st">"*"</span>, <span class="st">"cov3"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cov2"</span>, <span class="st">"+"</span>, <span class="st">"cov3"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cov1"</span>, <span class="st">"^"</span>, <span class="st">"3"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  keep <span class="op">=</span> <span class="st">"cov3"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Time-to-events can also follow a weibull distribution. Under this
setting, we are expected to enter the shape of the weibull distribution
which is 0.9 in this case. We let <em>beta = 0.5</em> to be the
coefficients for all covariates. Users can use <code><a href="../reference/set_event.html">?set_event</a></code>
to see more options.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_event.html">set_event</a></span><span class="op">(</span></span>
<span>  event <span class="op">=</span> <span class="st">"weibull"</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  lambdaC <span class="op">=</span> <span class="fl">0.0135</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For Weibull distribution, the goal is to find the hazard rate <span class="math inline">\(\lambda(t)\)</span> for patient with covariates
<span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
f(t) &amp;= \lambda e^{-\lambda t} \\
F(t) &amp;= 1 - e^{-\lambda t} \\
\lambda(t) &amp;= \lambda \\
\\
\lambda_c &amp;\text{: baseline constant hazard rate for internal
control patient with covariates } X = 0 \\
\text{HR} &amp;\text{: hazard ratio between internal treatment vs
control arm (proportional hazards)} \\
\text{driftHR} &amp;\text{: hazard ratio between external vs internal
control arm (proportional hazards)} \\
\text{I}(\text{trt}) &amp;\text{: treatment arm indicator}
\\
\text{Internal control}\\
\lambda &amp;= \lambda_c \times e^{log(\text{HR}) \times
\text{I}(\text{trt}) + X \beta} \\
&amp; = \lambda_c \times e^0 \times e^{X_{i} \beta} \\
&amp; = \lambda_c \times e^{X \beta} \\
\text{Internal treatment}\\
\lambda &amp;= \lambda_c \times e^{log(\text{HR}) \times
\text{I}(\text{trt}) + X \beta} \\
&amp; = \lambda_c \times e^{log(\text{HR}) + X \beta} \\
&amp; = \lambda_c \times \text{HR} \times e^{X \beta} \\
\text{External control} \\
\lambda &amp;= \lambda_c \times \text{driftHR} \times e^{X \beta}
\\
\text{Reparameterization for rweibull} \\
f(t) &amp;= \lambda e^{-\lambda t} \\
F(t) &amp;= 1 - e^{-\lambda t} \\
\lambda(t) &amp;= \lambda
\end{aligned}
\]</span></p>
</div>
<div class="section level3">
<h3 id="enrollment-pattern-drop-out-analysis-start-time">Enrollment pattern, drop-out, analysis start time<a class="anchor" aria-label="anchor" href="#enrollment-pattern-drop-out-analysis-start-time"></a>
</h3>
<p>Next, we specify the parameters for enrollment time, drop-out pattern
and analysis start time. Both enrollment time and time-to-exit follow
piece-wise exponential distribution.</p>
<p>The parameters are set separately for internal and external trials.
For internal trial, we recruit 2 patients per month in the first 5
months, 3 patients from month 6 to month 1, and 16 patients per month
after month 10. We assume dropouts at a rate of <code>etaC = 1</code>
per month for the control arm in the first 2 month and the rate
increases to 1.2 afterwards.</p>
<p>The analysis is set to start at 45 months after the study begins
(enrollment of the first patient) and a warning message will show if any
patient enrolled after this cut-off date and they will be excluded from
any future analysis.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_clin.html">set_clin</a></span><span class="op">(</span></span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>  e_itv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  CCOD <span class="op">=</span> <span class="st">"fixed-first"</span>,</span>
<span>  CCOD_t <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  etaC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.03</span><span class="op">)</span>,</span>
<span>  etaE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  d_itv <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the external trial, both the recruitment rate <code>gamma</code>
and the drop-out rate <code>etaC</code> are assumed to be constant. We
can skip <code>etaE</code> since the external trial contains data on
control arm only. Note that in this case, we do not need to specify
<em>e_itv</em> or <em>d_itv</em>. The cut-off date
<code>CCOD = "event"</code> means the analysis starts once 150 events
have been observed.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c_ext</span> <span class="op">=</span> <span class="fu"><a href="../reference/set_clin.html">set_clin</a></span><span class="op">(</span></span>
<span>  gamma <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  CCOD <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>  CCOD_t <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  etaC <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With all the information provided above, we simulate enrollment
pattern, time-to-events and time-to-dropout using function
<code><a href="../reference/simu_time.html">simu_time()</a></code>. User can also provide a seed value here
too.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simu_time.html">simu_time</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">sample_cov</span>,</span>
<span>  eventObj <span class="op">=</span> <span class="va">evt</span>,</span>
<span>  clinInt <span class="op">=</span> <span class="va">c_int</span>,</span>
<span>  clinExt <span class="op">=</span> <span class="va">c_ext</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">47</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><em>Example of one simulated dataset with time-to-events information
from output <code>sample_time</code>:</em></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample_time</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      driftHR   HR ext trt cov1 cov2        cov3 cov4 cov5       cov6       cov7</span></span>
<span><span class="co">#&gt; [1,]       1 0.67   0   1    0    0  1.69867515    0    0  1.4069318  1.4069318</span></span>
<span><span class="co">#&gt; [2,]       1 0.67   0   1    1    1 -0.42546841    1    1 -0.3578853 -0.3578853</span></span>
<span><span class="co">#&gt; [3,]       1 0.67   0   1    1    1 -0.04927021    0    0  0.1370222  0.1370222</span></span>
<span><span class="co">#&gt; [4,]       1 0.67   0   1    1    1 -0.42705058    0    0  0.3709728  0.3709728</span></span>
<span><span class="co">#&gt; [5,]       1 0.67   0   1    0    1 -0.10903808    0    0  0.2500303  0.2500303</span></span>
<span><span class="co">#&gt;            cov8      time cnsr</span></span>
<span><span class="co">#&gt; [1,]  1.4069318 0.1019925    0</span></span>
<span><span class="co">#&gt; [2,] -0.3578853 6.4700163    1</span></span>
<span><span class="co">#&gt; [3,]  0.1370222 3.5066896    1</span></span>
<span><span class="co">#&gt; [4,]  0.3709728 1.5454039    1</span></span>
<span><span class="co">#&gt; [5,]  0.2500303 6.8677445    0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-analysis">Bayesian analysis<a class="anchor" aria-label="anchor" href="#bayesian-analysis"></a>
</h2>
<p>In the last part, we want to generate a sequence of samples from the
posterior distribution of the parameters of interest using the JAGS
model. Here we call <code><a href="../reference/set_prior.html">set_prior()</a></code> to use all covariates as
predictors in the weibull distribution and use a half-cauchy
distribution for the precision parameter in hierarchical dynamic
borrowing.</p>
<p>Users are expected to enter the initial values for the following
parameters in the JAGS model:</p>
<ul>
<li>
<code>r0</code>: shape of the weibull distribution for
time-to-events</li>
<li>
<code>alpha</code>: log of baseline hazard rate for external and
internal control arms</li>
<li>
<code>d</code>: precision parameter</li>
</ul>
<p>For each dataset simulated, we can run Bayesian analysis using
different predictors or priors simultaneously. For this batch of priors
for testing, we choose to account for all covariates in the model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"cauchy"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0.03</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pr3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"no_ext"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pr4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"full_ext"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the next example, we use a propensity score calculated based on
two covariates <code>cov1</code> and <code>cov2</code> to be the
predictor in the weibull model. The propensity score are generated using
a logistic regression model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ps"</span>, <span class="st">"cov1"</span>, <span class="st">"cov2"</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Below we present some other examples of <code><a href="../reference/set_prior.html">set_prior()</a></code>.
Users can use <code><a href="../reference/set_prior.html">?set_prior</a></code> to see more options.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use no covariate. External arm will not be included in the Bayesian model</span></span>
<span><span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"no_ext"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use propensity score calculated using all covariates as predictor.</span></span>
<span><span class="co"># Hazard ratio = 1 for external and internal control arms</span></span>
<span><span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="st">"ps"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"full_ext"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use a subset of covaraites as predictors</span></span>
<span><span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span></span>
<span>  pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cov2"</span>, <span class="st">"cov5"</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"no_ext"</span>,</span>
<span>  r0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Lastly, we combine all four priors, and run MCMC to generate samples
from posterior distributions. The number of parallel chains for the
model, number of iterations for adaptation, number of iterations
discarded as burn-in and number of iterations to monitor are 2, 100,
100, 200 respectively. User can also provide a seed value. User can
choose to leverage parallel processing through calling
<code><a href="../reference/run_mcmc_p.html">run_mcmc_p()</a></code> instead of <code><a href="../reference/run_mcmc.html">run_mcmc()</a></code>.</p>
<p>If folder path <code>path</code> is provided, <code><a href="../reference/run_mcmc.html">run_mcmc()</a></code>
and <code><a href="../reference/run_mcmc_p.html">run_mcmc_p()</a></code> will output and save the MCMC result and
summary statistics.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pr1</span>, <span class="va">pr2</span>, <span class="va">pr3</span>, <span class="va">pr4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mcmc.html">run_mcmc</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">sample_time</span>,</span>
<span>  <span class="va">pr_list</span>, n.chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n.adapt <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  n.burn <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  n.iter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">47</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="posterior-summary-statistics">Posterior summary statistics<a class="anchor" aria-label="anchor" href="#posterior-summary-statistics"></a>
</h2>
<p>To generate summary statistics of one or multiple simulation
scenarios, we can call <code><a href="../reference/get_summary.html">get_summary()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_summary.html">get_summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><em>Example of the summary statistics from output
<code>summ</code>:</em></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summ</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>To visualize the results, users can call <code>plot_hr</code>,
<code>plot_type1error</code> and <code>plot_power</code> to see the
Bayesian posterior mean hazard ratios between the treatment and control
arm, as well as power, type I error implications.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_type1error.html">plot_type1error</a></span><span class="op">(</span></span>
<span>  <span class="va">summ</span>,</span>
<span>  driftHR <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-20-1.png"><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_power.html">plot_power</a></span><span class="op">(</span></span>
<span>  <span class="va">summ</span>,</span>
<span>  HR <span class="op">=</span> <span class="fl">0.67</span>,</span>
<span>  driftHR <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-20-2.png"><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_hr.html">plot_hr</a></span><span class="op">(</span></span>
<span>  <span class="va">summ</span>,</span>
<span>  HR <span class="op">=</span> <span class="fl">0.67</span>,</span>
<span>  driftHR <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-20-3.png"><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_bias.html">plot_bias</a></span><span class="op">(</span></span>
<span>  <span class="va">summ</span>,</span>
<span>  HR <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  driftHR <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-20-4.png"><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_mse.html">plot_mse</a></span><span class="op">(</span></span>
<span>  <span class="va">summ</span>,</span>
<span>  HR <span class="op">=</span> <span class="fl">0.67</span>,</span>
<span>  driftHR <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pred <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="user_guide_files/figure-html/unnamed-chunk-20-5.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="package-options">Package Options<a class="anchor" aria-label="anchor" href="#package-options"></a>
</h2>
<p>By default <code>psborrow</code> is quite chatty informing the user
explicitly about what assumptions it is making. If you want to suppress
these messages simply specify:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"psborrow.quiet"</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Isaac Gravestock, Craig Gower-Page, Yichen Lu, Aijing Lin, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
